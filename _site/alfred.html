<!DOCTYPE html>

<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>batman.js &mdash; alfred</title>
  
  <!-- Begin CSS -->
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/fancybox.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <!--[if !IE 7]><style type="text/css">#content-wrapper{display:table;height:100%}</style><![endif]-->
  <!-- End CSS -->
  
  <!-- Begin jquery -->
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
  <!-- End jquery -->
  
  <!-- Begin scripts -->
  <script type="text/javascript" src="http://use.typekit.com/kek3ffx.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script type="text/javascript" src="/js/scripts.js"></script>
  <script type="text/javascript" src="/js/jquery.tweet.js"></script>
  <script type="text/javascript" src="/js/jquery.fancybox-1.3.4.js"></script>
  <script type="text/javascript" src="/js/jquery.easing-1.3.pack.js"></script>
  <!-- End scripts -->

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-25319166-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>
<body id="sub">

  <!-- Begin header-wrapper -->
  <div id="header-wrapper">
    <div id="header">
      
      <!-- Begin logo -->
      <h1 id="logo">
        <a href="/">batman.js</a>
      </h1>
      <!-- End logo -->
      
      <!-- Begin navigation -->
      <div id="navigation">
        <ul>
          <li ><a href="/">Overview</a></li>
          <li ><a href="/download.html">Download</a></li>
          <li class="active"><a href="/examples.html">Examples</a></li>
          <li ><a href="/documentation.html">Documentation</a></li>
          <li ><a href="/community.html">Community</a></li>
        </ul>
      </div><div style="clear:both;"></div>
      <!-- End navigation -->
      
      
    </div>
  </div>
  <!-- End header-wrapper -->
  
  <!-- Begin content-wrapper -->
  <div id="content-wrapper">
    <div id="content">
      
      

        <!-- Begin left-sidebar -->
<div id="left-sidebar">

<ul class="subnav">
  
  
  <li><a href="/hello_world.html">Hello World</a></li>
  
  
  
  <li class="active">Alfred - Batman's Todos</li>
  
  
</ul>

</div>
<!-- End left-sidebar -->


<!-- Begin content-column-wrapper -->
<div id="content-column-wrapper">
  
  <h2>Alfred - Batman's Todos</h2>
  <p>Because no single-page app framework is complete without the canonical todo list example, here it is in just a few trivial lines of code.</p>
  <p>We'll setup our view in HTML, setup a model with inline CoffeeScript, and then bind everything together using batman.js.</p>
  
  
  
  <p><a href="/examples/alfred.html">Launch Alfred</a>. The completed code can be found in the <a href="http://github.com/Shopify/batman/blob/master/examples/alfred.html">repo</a>.</p>
  
    
  <h4>Layout</h4>
  
  <div class="highlight"><pre><code class="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Alfred: Batman&#39;s Todos<span class="nt">&lt;/title&gt;</span>

    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&#39;http://fonts.googleapis.com/css?family=Lobster&#39;</span> <span class="na">rel=</span><span class="s">&#39;stylesheet&#39;</span> <span class="na">type=</span><span class="s">&#39;text/css&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;resources/alfred.css&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;es5-shim.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;lib/batman.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h1&gt;</span>Alfred<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;form&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;new-item&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;add a todo item&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/form&gt;</span>

        <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;items&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;li&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;label&gt;</span>title<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;a&gt;</span>delete<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;&lt;span&gt;</span>number<span class="nt">&lt;/span&gt;</span> <span class="nt">&lt;span&gt;</span>of items<span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/coffeescript&quot;</span><span class="nt">&gt;</span>
    <span class="err">#</span> <span class="nx">Create</span> <span class="nx">our</span> <span class="nx">application</span><span class="p">.</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
  
</code></pre>
</div>

  <p>All the included resources may be found in the download above.</p>
  
  <h4>Application</h4>
  <p>First, we'll setup an instance of Batman.App. In addition to managing the our application lifecycle, the object acts as a namespace for all your other objects, like our Todo model.</p>
  
  <div class="highlight"><pre><code class="coffeescript"><span class="c1"># Create our application and namespace.</span>
<span class="k">class</span> <span class="nx">Alfred</span> <span class="k">extends</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">App</span>
  <span class="nx">@global</span> <span class="kc">yes</span>
  <span class="nx">@root</span> <span class="s1">&#39;todos#index&#39;</span>


<span class="c1"># Define the principle Todo model with `body` and `isDone` attributes, and tell it to persist itself using Local Storage.</span>
<span class="k">class</span> <span class="nx">Alfred</span><span class="p">.</span><span class="nx">Todo</span> <span class="k">extends</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span>
  <span class="nx">@global</span> <span class="kc">yes</span> <span class="c1"># global exposes this class on the global object, so you can access `Todo` directly.</span>

  <span class="nx">@persist</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">LocalStorage</span>
  <span class="nx">@encode</span> <span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="s1">&#39;isDone&#39;</span>

  <span class="nv">body: </span><span class="s1">&#39;&#39;</span>
  <span class="nv">isDone: </span><span class="kc">false</span>


<span class="k">class</span> <span class="nx">Alfred</span><span class="p">.</span><span class="nx">TodosController</span> <span class="k">extends</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Controller</span>
  <span class="nv">index: </span><span class="o">-&gt;</span>
    <span class="c1"># setup a binding for the new form</span>
    <span class="nx">@set</span> <span class="s1">&#39;emptyTodo&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Todo</span>

    <span class="c1"># add some example todos to show off.</span>
    <span class="nx">Todo</span><span class="p">.</span><span class="nx">load</span> <span class="nf">(todos) -&gt;</span>
      <span class="k">if</span> <span class="o">not</span> <span class="nx">todos</span><span class="p">.</span><span class="nx">length</span>
        <span class="k">new</span> <span class="nx">Todo</span><span class="p">(</span><span class="nv">body: </span><span class="s1">&#39;joker escaped arkham again&#39;</span><span class="p">,</span> <span class="nv">isDone: </span><span class="kc">true</span><span class="p">).</span><span class="nx">save</span><span class="p">()</span>
        <span class="k">new</span> <span class="nx">Todo</span><span class="p">(</span><span class="nv">body: </span><span class="s1">&#39;riddler sent riemann hypothesis&#39;</span><span class="p">).</span><span class="nx">save</span><span class="p">()</span>
        <span class="k">new</span> <span class="nx">Todo</span><span class="p">(</span><span class="nv">body: </span><span class="s1">&#39;bane wants to meet, not worried&#39;</span><span class="p">).</span><span class="nx">save</span><span class="p">()</span>

    <span class="c1"># return false to prevent the implicit render of views/todos/index.html</span>
    <span class="k">return</span> <span class="kc">false</span>

  <span class="nv">create: </span><span class="o">=&gt;</span>
    <span class="nx">@emptyTodo</span><span class="p">.</span><span class="nx">save</span> <span class="o">=&gt;</span>
      <span class="nx">@set</span> <span class="s1">&#39;emptyTodo&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Todo</span>

    <span class="k">return</span> <span class="kc">false</span>


<span class="c1"># Start the app</span>
<span class="nx">Alfred</span><span class="p">.</span><span class="nx">run</span><span class="p">()</span>
  
</code></pre>
</div>

  
  <h4>Bindings</h4>
  <p>Finally, we can now setup our HTML to bind to our working application. This makes everything come to live, with no additional code!</p>
  <p>We start by iterating over Todo.all (a copy of this li will be made for each item, and whenever a new item is added). The iterated item will be available under the key we specify, in this case <code>todo</code>.</p>
  <div class="highlight"><pre><code class="html"><span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;items&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;li</span> <span class="na">data-foreach-todo=</span><span class="s">&quot;Todo.all&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
  
</code></pre>
</div>

  
  <p>Next, we can use <code>data-bind</code> to set the value of nodes within our iterator. Input nodes, like the checkbox, are smart enough to set the correct attribute.</p>
  <div class="highlight"><pre><code class="html"><span class="nt">&lt;li</span> <span class="na">data-foreach-todo=</span><span class="s">&quot;Todo.all&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;todo.isDone&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">data-bind=</span><span class="s">&quot;todo.body&quot;</span><span class="nt">&gt;&lt;/label&gt;</span>
<span class="nt">&lt;/li&gt;</span>
  
</code></pre>
</div>

  
  <p>There are many other <code>data-*</code> attributes we can use to add complex behaviors. For example, here we'll add the class name <code>done</code> to our label when a certain binding evaluates to true.</p>
  <div class="highlight"><pre><code class="html"><span class="nt">&lt;li</span> <span class="na">data-foreach-todo=</span><span class="s">&quot;Todo.all&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;todo.isDone&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">data-bind=</span><span class="s">&quot;todo.body&quot;</span> <span class="na">data-addclass-done=</span><span class="s">&quot;todo.isDone&quot;</span><span class="nt">&gt;&lt;/label&gt;</span>
<span class="nt">&lt;/li&gt;</span>
  
</code></pre>
</div>

  
  <p>Two new attributes. <code>data-mixin</code> will apply all of the properties from the given named bucket to this node, allowing for more complex behavior.</p>
  <p><code>data-event-*</code> allows us to easily add event handlers to a node. There are a few advantages over <code>onclick</code>: it will use <code>addEventListener</code>, let us access runtime methods, and we can support some more specialized events.</p>
  <div class="highlight"><pre><code class="html"><span class="nt">&lt;li</span> <span class="na">data-foreach-todo=</span><span class="s">&quot;Todo.all&quot;</span> <span class="na">data-mixin=</span><span class="s">&quot;animation&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;todo.isDone&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">data-bind=</span><span class="s">&quot;todo.body&quot;</span> <span class="na">data-mixin=</span><span class="s">&quot;editable&quot;</span> <span class="na">data-addclass-done=</span><span class="s">&quot;todo.isDone&quot;</span><span class="nt">&gt;&lt;/label&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">data-event-click=</span><span class="s">&quot;todo.destroy&quot;</span><span class="nt">&gt;</span>delete<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/li&gt;</span>
  
</code></pre>
</div>

  
  <p>Bindings also support a Liquid-like filter syntax, allowing you to create more complex bindings without any additional presenter logic or code.</p>
  <div class="highlight"><pre><code class="html"><span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;items&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;li</span> <span class="na">data-foreach-todo=</span><span class="s">&quot;Todo.all&quot;</span><span class="nt">&gt;</span>...<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;Todo.all.length&quot;</span><span class="nt">&gt;&lt;/span&gt;</span> <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;&#39;item&#39; | pluralize Todo.all.length&quot;</span><span class="nt">&gt;&lt;/span&gt;&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
  
</code></pre>
</div>


  <p>Finally, we can wire up our form to our controller in order to create new todos. The controllers object used here is an easy way to access the singleton instances of all controllers currently running in the app.</p>
  <div class="highlight"><pre><code class="html">  <span class="nt">&lt;form</span> <span class="na">data-formfor-todo=</span><span class="s">&quot;controllers.todos.emptyTodo&quot;</span> <span class="na">data-event-submit=</span><span class="s">&quot;controllers.todos.create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">&quot;new-item&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;add a todo item&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;todo.body&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
  
</code></pre>
</div>

  
  <h4>Fin</h4>
  
  <p><a href="/examples/alfred.html">Launch Alfred</a>. The completed code can be found in the <a href="http://github.com/Shopify/batman/blob/master/examples/alfred.html">repo</a>.</p>
  
  
</div>
<!-- End content-column-wrapper -->

      
      
      
    </div>
  </div>
  <!-- Begin content-wrapper -->
  
  <!-- Begin footer-wrapper -->
  <div id="footer-wrapper">
   <div id="footer-content">

    <ul>
      <li>
        <a class="shopify-logo" href="http://www.shopify.com" target="_blank"><img src="/images/logo-shopify.png" width="185" height="54" /></a>
        Copyright 2011 &ndash; Shopify. Released under the <a href="http://www.opensource.org/licenses/mit-license.php" target="_blank">MIT license</a>.<br />
        batman.js is a Shopify project, created by <a href="http://github.com/nciagra">Nick Small</a>. <a href="http://github.com/shopify/batman" class="inline-link">GitHub</a> <a href="http://twitter.com/nciagra" class="inline-link">Twitter</a></li>
    </ul>

   </div>
  </div>
  <!-- End footer-wrapper -->

</body>
</html>