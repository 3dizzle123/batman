<!DOCTYPE html>
<html>
<head>
    <title>Alfred: Batman's Todos</title>
    
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="resources/alfred.css" type="text/css">
    
    <script type="text/javascript" src="../lib/coffee-script.js"></script>
    <script type="text/javascript" src="../lib/batman.js"></script>
</head>

<body>
    <div id="container">
        <h1>Alfred</h1>
        
        <form data-formfor-todo="Todo.create" data-event-submit="todo.save">
          <input class="new-item" placeholder="add a todo item" data-bind="todo.body" />
        </form>
        
        <ul id="items">
            <li data-each-todo="Todo.all" data-mixin="animation">
                <input type="checkbox" data-bind="todo.isDone" />
                <label data-bind="todo.body" data-class-done="todo.isDone" data-mixin="editable"></label>
                <a data-event-click="todo.destroy">delete</a>
            </li>
            <li id="item-count"></li>
        </ul>
    </div>
    
    <script type="text/coffeescript">
    class Alfred extends Batman.App
    
    class Alfred.Todo extends Batman.Model
      body: ''
      isDone: no
    
    Alfred.run()
    
    Todo.observe 'all', (array) ->
      count = array.length
      document.getElementById('item-count').innerHTML = "#{count} #{Batman.helpers.pluralize count, 'item'}"
    
    if not Todo.all().length
      new Todo(body: 'joker escaped arkham again', isDone: true).save()
      new Todo(body: 'riddler sent riemann hypothesis').save()
      new Todo(body: 'bane wants to meet, not worried').save()
    </script>
</body>
</html>
